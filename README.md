# MeshChat CLI

MeshChat CLI — это клиент для чата MeshCore с полноэкранным интерфейсом, позволяющий взаимодействовать с MeshCore-устройствами через командную строку.

## Особенности

- **Полноэкранный интерфейс**: Использует prompt_toolkit для создания полнофункционального терминального интерфейса
- **Отображение сообщений**: Полученные и отправленные сообщения отображаются в хронологическом порядке
- **Статусы сообщений**: Отображение статуса доставки сообщений (ожидание, доставлено, ошибка)
- **История сообщений**: Автоматическое сохранение сообщений в файлы по каналам
- **Конфигурация**: Сохранение параметров подключения в файле конфигурации
- **Статусная строка**: Информация о подключении, имени устройства и статусе последнего сообщения
- **Инструкции в интерфейсе**: Подсказки по использованию расположены в нижней части экрана

## Установка

### Установка через pip (для систем без ограничений на управление пакетами)

```bash
pip install meshcore-cli
```

### Установка для систем с PEP 668 (например, свежие версии Ubuntu/macOS с Homebrew Python)

Если при установке возникает ошибка `externally-managed-environment`, выполните:

```bash
pip install meshcore-cli --break-system-packages
```

### Альтернативный способ установки через pipx

Рекомендуется использовать `pipx` для установки приложений Python глобально:

```bash
pipx install meshcore-cli
```

Если `pipx` не установлен:

- На macOS: `brew install pipx`
- На Linux: `pip install --user pipx`

Затем:

```bash
pipx ensurepath
pipx install meshcore-cli
```

## Использование

При первом запуске программа запросит параметры подключения (IP-адрес и порт) и сохранит их в файл конфигурации `~/.config/meshcore/mesh-cli.json`.

### Запуск после установки

```bash
meshchat
```

### Для разработчиков (локальная установка)

Если вы клонировали репозиторий и хотите запустить скрипт локально:

1. Установите зависимости:
   ```bash
   pip install meshcore prompt_toolkit pycryptodome
   ```

   Или с флагом для систем с PEP 668:
   ```bash
   pip install meshcore prompt_toolkit pycryptodome --break-system-packages
   ```

2. Запустите напрямую:
   ```bash
   python meshchat.py
   ```

Для отправки сообщений используйте формат:
```
#канал: сообщение
```

Например:
```
#connections: Привет всем!
```

## Формат сообщений

- Входящие сообщения: `[17-Jan-26 21:34:49] #канал: [пользователь] текст`
- Исходящие сообщения: `[17-Jan-26 21:34:49] #канал: [пользователь] текст [статус]`

## Статусы сообщений

- `●` — сообщение отправляется
- `✓` — сообщение принято устройством
- `✓✓` — сообщение доставлено успешно
- `⚠` — таймаут ожидания подтверждения
- `✗` — ошибка отправки

## Команды

- `help` — показать список доступных каналов и пользователей
- `Ctrl+C` — выход из программы

## Конфигурация

Параметры подключения сохраняются в `~/.config/meshcore/mesh-cli.json` и используются при последующих запусках.

## Требования

- Python 3.8+
- Библиотеки: meshcore, prompt_toolkit, pycryptodome

## Диагностика и проверка установки

Для проверки корректности установки можно использовать скрипт диагностики:

```bash
python check_installation.py
```

Он проверит:
- Совместимость версии Python
- Наличие всех необходимых зависимостей
- Доступность исполняемой команды `meshchat`

## Лицензия

MIT
